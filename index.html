<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VIP Gewinnspiel - autodetails96</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&family=Montserrat:wght@800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold-primary: #fbbf24;
            --gold-secondary: #d97706;
            --gold-dark: #78350f;
            --gold-light: #fef3c7;
            --luxury-gradient: linear-gradient(135deg, #fcd34d 0%, #fbbf24 25%, #d97706 50%, #b45309 75%, #78350f 100%);
        }

        body {
            background-color: #020617;
            background-image: 
                radial-gradient(circle at 50% -20%, rgba(251, 191, 36, 0.2) 0%, transparent 60%),
                radial-gradient(circle at 0% 100%, rgba(30, 41, 59, 1) 0%, transparent 40%);
            font-family: 'Inter', sans-serif;
            color: #f8fafc;
            overflow: hidden;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.85);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(251, 191, 36, 0.2);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
        }

        .wheel-outer-frame {
            position: relative;
            padding: 14px;
            background: var(--luxury-gradient);
            border-radius: 50%;
            box-shadow: 0 0 50px rgba(0,0,0,0.7), inset 0 2px 4px rgba(255,255,255,0.4);
            z-index: 10;
        }

        .led-light {
            position: absolute;
            width: 7px;
            height: 7px;
            background: #fff;
            border-radius: 50%;
            z-index: 20;
            pointer-events: none;
        }

        @keyframes led-blink {
            0%, 100% { opacity: 0.2; filter: brightness(0.5); }
            50% { opacity: 1; filter: brightness(1.3) drop-shadow(0 0 6px #fbbf24); }
        }

        .wheel-container {
            position: relative;
            width: 290px;
            height: 290px;
            border-radius: 50%;
            background: #0f172a;
            overflow: hidden;
            border: 8px solid #0f172a;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
        }

        @media (min-width: 440px) {
            .wheel-container { width: 340px; height: 340px; }
        }

        #wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            transition: transform 7s cubic-bezier(0.1, 0, 0, 1);
            will-change: transform;
        }

        .wheel-center-cap {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 64px; height: 64px;
            background: radial-gradient(circle at 30% 30%, #475569, #020617);
            border: 3px solid #fbbf24;
            border-radius: 50%;
            z-index: 50;
            box-shadow: 0 8px 20px rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
        }

        .stopper {
            position: absolute;
            top: -22px;
            left: 50%;
            transform: translateX(-50%);
            width: 38px;
            height: 48px;
            background: linear-gradient(to bottom, #fef3c7, #fbbf24, #d97706);
            clip-path: polygon(15% 0%, 85% 0%, 100% 20%, 50% 100%, 0% 20%);
            z-index: 100;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.6));
            transform-origin: top center;
            transition: transform 0.1s ease-out;
        }

        .btn-gold {
            background: var(--luxury-gradient);
            color: #000;
            font-weight: 900;
            box-shadow: 0 10px 30px -5px rgba(180, 83, 9, 0.4);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .btn-gold:hover:not(:disabled) {
            transform: translateY(-3px) scale(1.02);
            filter: brightness(1.1);
        }

        .btn-gold:disabled {
            opacity: 0.4;
            transform: scale(0.98);
            cursor: not-allowed;
            filter: grayscale(0.8);
        }

        .modal-enter { animation: modalFade 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
        @keyframes modalFade {
            from { opacity: 0; transform: translateY(20px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .modal-exit { animation: modalFadeOut 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
        @keyframes modalFadeOut {
            from { opacity: 1; transform: translateY(0) scale(1); }
            to { opacity: 0; transform: translateY(20px) scale(0.95); }
        }
    </style>
</head>
<body class="p-4">

    <div class="glass-panel rounded-[3rem] p-1 w-full max-w-[460px] relative">
        <div class="bg-slate-900/40 rounded-[2.8rem] p-8 md:p-10 flex flex-col items-center">
            
            <!-- Branding -->
            <div class="mb-8 text-center">
                <a href="https://www.ebay.de/usr/autodetails96" target="_blank" class="block h-14 mb-4 filter drop-shadow-[0_0_12px_rgba(251,191,36,0.2)] hover:scale-105 transition-transform cursor-pointer">
                    <img src="https://www.dropbox.com/scl/fi/rci57ohupbfz8nktotrff/autodetails96.png?rlkey=myk6hp9st9f8pjb1th1xsuhuj&st=qri65fou&raw=1" 
                         alt="AutoDetails96" class="h-full mx-auto object-contain">
                </a>
                <div class="inline-flex items-center gap-2 px-4 py-1 rounded-full border border-amber-500/20 bg-amber-500/5">
                    <span class="relative flex h-2 w-2">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-400 opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-2 w-2 bg-amber-500"></span>
                    </span>
                    <span class="text-amber-400 text-[10px] font-black tracking-[0.2em] uppercase">VIP Reward System</span>
                </div>
            </div>

            <!-- Wheel Interface -->
            <div class="wheel-outer-frame mb-10" id="wheelFrame">
                <div class="stopper" id="stopper"></div>
                <div class="wheel-container">
                    <div id="wheel"></div>
                </div>
                <div class="wheel-center-cap">
                    <span class="text-[10px] font-black text-amber-500 italic tracking-tighter">AD96</span>
                </div>
            </div>

            <!-- Controls -->
            <button id="spinBtn" onclick="spinWheel()" class="btn-gold w-full py-5 rounded-2xl text-lg uppercase tracking-widest mb-6">
                GL√úCKSRAD DREHEN
            </button>
            
            <!-- Trust Footer -->
            <div class="w-full border-t border-white/5 pt-6 flex flex-col items-center gap-3">
                <button onclick="toggleModal('legalOverlay', true)" class="text-slate-500 hover:text-amber-400 text-[11px] font-medium transition-colors flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>
                    <span>Impressum & Datenschutz</span>
                </button>
                <p class="text-[9px] text-slate-600 font-bold uppercase tracking-widest">¬© 2026 autodetails96</p>
            </div>
        </div>
    </div>

    <!-- Results Experience -->
    <div id="resultOverlay" class="fixed inset-0 z-[200] bg-slate-950/95 backdrop-blur-xl hidden flex items-center justify-center p-4">
        <div id="modalBox" class="glass-panel p-10 rounded-[3rem] max-w-sm w-full text-center border-amber-500/30 shadow-[0_0_100px_rgba(251,191,36,0.15)]">
            
            <!-- Win Layout -->
            <div id="winContent" class="hidden">
                <div class="text-6xl mb-6">üèÜ</div>
                <h2 class="text-4xl font-black text-white mb-2 uppercase italic">Gl√ºckwunsch!</h2>
                
                <div class="my-8 py-6 bg-amber-500/5 rounded-3xl border border-amber-500/10">
                    <span class="text-8xl font-black text-transparent bg-clip-text bg-gradient-to-b from-amber-100 to-amber-600" id="discountDisplay">10%</span>
                    <p class="text-amber-500 font-bold text-xs tracking-[0.4em] uppercase mt-3">Exklusiv-Rabatt</p>
                </div>

                <div class="bg-black/40 rounded-2xl p-5 border border-white/5 mb-8">
                    <p class="text-[12px] text-slate-400 mb-4 italic leading-relaxed">"Schicke mir diesen Code per eBay-Nachricht, –∏ —è –ø—Ä–∏–º–µ–Ω—é —Å–∫–∏–¥–∫—É –∫ —Ç–≤–æ–µ–º—É –∑–∞–∫–∞–∑—É"</p>
                    <div class="flex items-center gap-3 bg-slate-900 p-3 rounded-xl border border-amber-500/30">
                        <code id="code" class="flex-1 text-xl font-mono font-bold text-white tracking-widest">---</code>
                        <button onclick="copyCode()" class="bg-amber-500 text-black p-2.5 rounded-lg hover:bg-amber-400 transition-transform active:scale-90">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
                        </button>
                    </div>
                </div>

                <a href="https://www.ebay.de/usr/autodetails96" target="_blank" class="btn-gold block w-full py-5 rounded-2xl no-underline text-center font-black mb-6">
                    JETZT EINL√ñSEN
                </a>
                <button onclick="closeResult()" class="text-slate-500 text-[10px] uppercase font-bold tracking-widest hover:text-white transition-colors">Fenster schlie√üen</button>
            </div>

            <!-- Lose Layout -->
            <div id="loseContent" class="hidden">
                <div class="text-6xl mb-6 opacity-30">üé°</div>
                <h2 class="text-2xl font-bold text-white mb-4">Fast geschafft!</h2>
                <p class="text-slate-400 text-sm mb-10 leading-relaxed">Diesmal war das Gl√ºck knapp daneben. Aber keine Sorge ‚Äî wir haben tolle Angebote auch ohne Code!</p>
                <a href="https://www.ebay.de/usr/autodetails96" target="_blank" class="block w-full border border-white/10 py-5 rounded-2xl text-white font-bold no-underline mb-6 hover:bg-white/5 transition-all">
                    Zum eBay Shop
                </a>
                <button onclick="closeResult()" class="text-slate-500 text-[10px] uppercase font-bold tracking-widest hover:text-white transition-colors">Zur√ºck</button>
            </div>
        </div>
    </div>

    <!-- Legal Modal -->
    <div id="legalOverlay" class="fixed inset-0 z-[300] bg-slate-950/98 hidden flex items-center justify-center p-8">
        <div class="max-w-md w-full bg-slate-900 border border-white/5 p-8 rounded-[2rem] space-y-5">
            <h3 class="text-amber-500 font-black text-xl uppercase italic">Rechtliche Hinweise</h3>
            <div class="text-xs text-slate-400 space-y-4 leading-relaxed">
                <p><strong class="text-white">Marketing-Aktion:</strong> Dieses Gl√ºcksrad ist eine kostenlose Marketing-Aktion zur Verkaufsf√∂rderung (Werbeaktion). Es besteht kein rechtlicher Anspruch auf einen Gewinn oder eine Barauszahlung.</p>
                <p><strong class="text-white">Impressum:</strong> autodetails96 (Privatverk√§ufer). Die Abwicklung erfolgt ausschlie√ülich √ºber die eBay-Plattform unter Einhaltung der dort geltenden Verkaufsbedingungen.</p>
                <p><strong class="text-white">Datenschutz:</strong> Es werden keine personenbezogenen Daten gespeichert. LocalStorage dient nur zur technischen Unterbindung von Mehrfachteilnahmen.</p>
                <p>Das Angebot ist freiwillig –∏ gilt nur solange der Vorrat reicht.</p>
            </div>
            <button onclick="toggleModal('legalOverlay', false)" class="w-full py-4 bg-slate-800 text-white rounded-xl text-xs font-black uppercase tracking-widest">Schlie√üen</button>
        </div>
    </div>

    <div id="toast" class="fixed bottom-10 left-1/2 -translate-x-1/2 bg-amber-500 text-black px-10 py-4 rounded-full font-black text-xs tracking-[0.3em] opacity-0 translate-y-20 transition-all duration-500 z-[400] pointer-events-none shadow-2xl">
        KOPIERT!
    </div>

    <script>
        const segments = [
            { text: "10%", val: 10, bg: "#1e293b", color: "#fbbf24" },
            { text: "0%",  val: 0,  bg: "#0f172a", color: "#475569" },
            { text: "5%",  val: 5,  bg: "#334155", color: "#ffffff" },
            { text: "0%",  val: 0,  bg: "#0f172a", color: "#475569" },
            { text: "10%", val: 10, bg: "#1e293b", color: "#fbbf24" },
            { text: "2%",  val: 2,  bg: "#1e293b", color: "#ffffff" },
            { text: "5%",  val: 5,  bg: "#334155", color: "#ffffff" },
            { text: "0%",  val: 0,  bg: "#0f172a", color: "#475569" }
        ];

        const weights = [1, 55, 7, 45, 1, 25, 7, 45]; 
        const wheel = document.getElementById('wheel');
        const stopper = document.getElementById('stopper');
        const wheelFrame = document.getElementById('wheelFrame');
        const STORAGE_KEY = 'ad96_final_2026_locked';

        const AudioCtx = window.AudioContext || window.webkitAudioContext;
        let audioCtx = null;

        function playTickSound() {
            try {
                if (!audioCtx) audioCtx = new AudioCtx();
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'square';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(40, audioCtx.currentTime + 0.1);
                gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.1);
            } catch(e) {}
        }

        function init() {
            // LED Lights Generation
            const ledCount = 24;
            for(let i=0; i<ledCount; i++) {
                const led = document.createElement('div');
                led.className = 'led-light';
                const angle = (i * (360/ledCount)) * (Math.PI / 180);
                const r = (wheelFrame.offsetWidth / 2) - 7;
                led.style.left = `calc(50% + ${r * Math.cos(angle)}px - 3.5px)`;
                led.style.top = `calc(50% + ${r * Math.sin(angle)}px - 3.5px)`;
                led.style.animation = `led-blink 1.2s infinite ${i * 0.05}s`;
                wheelFrame.appendChild(led);
            }

            // Wheel Sections Generation
            const step = 360 / segments.length;
            let conicParts = segments.map((s, i) => `${s.bg} ${i*step}deg ${(i+1)*step}deg`).join(', ');
            wheel.style.background = `conic-gradient(${conicParts})`;

            segments.forEach((s, i) => {
                const label = document.createElement('div');
                Object.assign(label.style, { position: 'absolute', top: '50%', left: '50%', transformOrigin: 'center' });
                const midAngle = (i * step) + (step/2);
                const rad = (midAngle - 90) * (Math.PI / 180);
                const dist = wheel.offsetWidth / 2.7;
                const x = dist * Math.cos(rad);
                const y = dist * Math.sin(rad);
                label.style.transform = `translate(calc(-50% + ${x}px), calc(-50% + ${y}px)) rotate(${midAngle}deg)`;
                label.innerHTML = `<span style="color: ${s.color}; font-weight: 900; font-size: 1.15rem; font-family: Montserrat">${s.text === '0%' ? '‚úï' : s.text}</span>`;
                wheel.appendChild(label);
            });

            // Restore State if already played
            if(localStorage.getItem(STORAGE_KEY)) {
                disableButton("BEENDET");
            }
        }

        let isSpinning = false;

        function spinWheel() {
            if(isSpinning || localStorage.getItem(STORAGE_KEY)) return;
            isSpinning = true;

            const totalWeight = weights.reduce((a, b) => a + b, 0);
            let rand = Math.random() * totalWeight;
            let winIdx = 0;
            for(let i=0; i<weights.length; i++){
                if(rand < weights[i]) { winIdx = i; break; }
                rand -= weights[i];
            }

            const degPerSect = 360 / segments.length;
            const extraSpins = 360 * 10;
            const targetDeg = (360 - (winIdx * degPerSect) - (degPerSect/2));
            const finalRotation = extraSpins + targetDeg;

            wheel.style.transform = `rotate(${finalRotation}deg)`;
            localStorage.setItem(STORAGE_KEY, 'true');

            // Stopper Logic
            let lastTickAngle = 0;
            const checkTick = () => {
                if(!isSpinning) return;
                const style = window.getComputedStyle(wheel);
                const matrix = new WebKitCSSMatrix(style.transform);
                const angle = Math.round(Math.atan2(matrix.b, matrix.a) * (180/Math.PI));
                const normalizedAngle = (angle < 0 ? angle + 360 : angle);
                const sectorAngle = 360 / segments.length;
                const currentSector = Math.floor(((360 - normalizedAngle + (sectorAngle/2)) % 360) / sectorAngle);
                
                if(currentSector !== lastTickAngle) {
                    lastTickAngle = currentSector;
                    stopper.style.transform = 'translateX(-50%) rotate(-25deg)';
                    playTickSound();
                    setTimeout(() => stopper.style.transform = 'translateX(-50%) rotate(0deg)', 80);
                }
                requestAnimationFrame(checkTick);
            };
            requestAnimationFrame(checkTick);

            setTimeout(() => {
                isSpinning = false;
                showResult(segments[winIdx]);
                disableButton("BEENDET");
            }, 7200);
        }

        function showResult(winner) {
            const overlay = document.getElementById('resultOverlay');
            const box = document.getElementById('modalBox');
            
            document.getElementById('winContent').classList.add('hidden');
            document.getElementById('loseContent').classList.add('hidden');

            overlay.classList.remove('hidden');
            box.classList.remove('modal-exit');
            box.classList.add('modal-enter');

            if(winner.val > 0) {
                document.getElementById('winContent').classList.remove('hidden');
                document.getElementById('discountDisplay').innerText = winner.text;
                const codes = { 10: 'VIP96-GOLD', 5: 'VIP96-SILVER', 2: 'VIP96-BRONZE' };
                document.getElementById('code').innerText = codes[winner.val] || 'AD96-WIN';
                confetti({ particleCount: 200, spread: 80, origin: { y: 0.6 }, colors: ['#fbbf24', '#ffffff'] });
            } else {
                document.getElementById('loseContent').classList.remove('hidden');
            }
        }

        function closeResult() {
            const overlay = document.getElementById('resultOverlay');
            const box = document.getElementById('modalBox');
            
            box.classList.remove('modal-enter');
            box.classList.add('modal-exit');
            
            setTimeout(() => {
                overlay.classList.add('hidden');
            }, 400);
        }

        async function copyCode() {
            const code = document.getElementById('code').innerText;
            try {
                await navigator.clipboard.writeText(code);
            } catch (err) {
                const textArea = document.createElement("textarea");
                textArea.value = code;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
            }
            const t = document.getElementById('toast');
            t.classList.remove('opacity-0', 'translate-y-20');
            setTimeout(() => t.classList.add('opacity-0', 'translate-y-20'), 2500);
        }

        function toggleModal(id, show) {
            document.getElementById(id).classList.toggle('hidden', !show);
        }

        function disableButton(txt) {
            const btn = document.getElementById('spinBtn');
            btn.disabled = true;
            btn.innerText = txt;
        }

        window.onload = init;
    </script>
</body>
</html>